<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Chat</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Name Entry Popup -->
    <div id="namePopup" class="popup">
        <div class="popup-content">
            <div class="wa-logo">üí¨</div>
            <h2>Welcome to Chat</h2>
            <p>Enter your name to continue</p>
            <input type="text" id="userName" placeholder="Your name" maxlength="25">
            <button onclick="setUserName()" class="wa-btn">Continue</button>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden">
        <!-- WhatsApp Header -->
        <header class="wa-header">
            <div class="wa-header-content">
                <h1>Chats</h1>
                <div class="wa-header-actions">
                    <span id="currentUser"></span>
                    <div class="connection-dot" id="connectionDot"></div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div id="mainContent" class="wa-main">
            <!-- Groups List -->
            <div id="groupsList" class="wa-chats">
                <div class="wa-actions">
                    <button onclick="createGroup()" class="wa-action-btn">
                        <span class="wa-icon">‚ûï</span>
                        New Group
                    </button>
                    <button onclick="showJoinGroup()" class="wa-action-btn">
                        <span class="wa-icon">üîó</span>
                        Join Group
                    </button>
                </div>
                
                <div id="joinGroupForm" class="wa-join-form hidden">
                    <input type="text" id="groupLink" placeholder="Enter group code or link">
                    <div class="wa-join-actions">
                        <button onclick="joinGroup()" class="wa-btn">Join</button>
                        <button onclick="hideJoinGroup()" class="wa-btn-secondary">Cancel</button>
                    </div>
                </div>

                <div class="wa-chats-list">
                    <div id="groups"></div>
                </div>
            </div>

            <!-- Chat Interface -->
            <div id="chatInterface" class="wa-chat hidden">
                <!-- Chat Header -->
                <div class="wa-chat-header">
                    <button onclick="backToGroups()" class="wa-back-btn">‚Üê</button>
                    <div class="wa-chat-info">
                        <h3 id="groupName"></h3>
                        <small id="groupMembers"></small>
                    </div>
                    <div class="wa-chat-actions">
                        <button onclick="showGroupMenu()" class="wa-menu-btn">‚ãÆ</button>
                    </div>
                </div>

                <!-- Messages -->
                <div id="messages" class="wa-messages"></div>
                
                <!-- Reply Preview -->
                <div id="replyPreview" class="wa-replying-to hidden">
                    <div>
                        <div id="replyToUser"></div>
                        <div id="replyToText"></div>
                    </div>
                    <button onclick="cancelReply()" class="wa-cancel-reply">√ó</button>
                </div>
                
                <!-- Message Input -->
                <div class="wa-input-area">
                    <button onclick="toggleEmoji()" class="wa-emoji-btn">üòä</button>
                    <input type="text" id="messageText" placeholder="Type a message" onkeypress="handleEnter(event)">
                    <button onclick="sendMessage()" class="wa-send-btn">‚û§</button>
                </div>

                <!-- Emoji Picker -->
                <div id="emojiPicker" class="wa-emoji-picker hidden">
                    <div class="wa-emoji-grid">
                        <span onclick="addEmoji('üòÄ')">üòÄ</span>
                        <span onclick="addEmoji('üòÇ')">üòÇ</span>
                        <span onclick="addEmoji('üòç')">üòç</span>
                        <span onclick="addEmoji('ü§î')">ü§î</span>
                        <span onclick="addEmoji('üòä')">üòä</span>
                        <span onclick="addEmoji('üòé')">üòé</span>
                        <span onclick="addEmoji('üëç')">üëç</span>
                        <span onclick="addEmoji('üëé')">üëé</span>
                        <span onclick="addEmoji('‚ù§Ô∏è')">‚ù§Ô∏è</span>
                        <span onclick="addEmoji('üî•')">üî•</span>
                        <span onclick="addEmoji('üíØ')">üíØ</span>
                        <span onclick="addEmoji('üéâ')">üéâ</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Group Menu -->
    <div id="groupMenu" class="wa-menu hidden">
        <div class="wa-menu-content">
            <button onclick="showGroupInfo()" class="wa-menu-item">
                <span class="wa-menu-icon">‚ÑπÔ∏è</span>
                Group Info
            </button>
            <button onclick="leaveGroup()" class="wa-menu-item wa-menu-danger">
                <span class="wa-menu-icon">üö™</span>
                Leave Group
            </button>
        </div>
    </div>

    <!-- Group Info Modal -->
    <div id="groupInfo" class="popup hidden">
        <div class="popup-content">
            <h3>Group Info</h3>
            <div class="wa-group-code">
                <label>Group Code:</label>
                <div class="wa-code-display">
                    <span id="displayGroupCode"></span>
                    <button onclick="copyGroupCode()" class="wa-copy-btn">Copy</button>
                </div>
            </div>
            <div class="wa-members">
                <h4>Members</h4>
                <div id="membersList"></div>
            </div>
            <button onclick="hideGroupInfo()" class="wa-btn">Close</button>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="createGroupModal" class="popup hidden">
        <div class="popup-content">
            <h3>New Group</h3>
            <input type="text" id="newGroupName" placeholder="Group name" maxlength="25">
            <div class="wa-modal-actions">
                <button onclick="confirmCreateGroup()" class="wa-btn">Create</button>
                <button onclick="hideCreateGroup()" class="wa-btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
</body>
</html>